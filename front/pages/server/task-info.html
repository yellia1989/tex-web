<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>任务详情</title>
  <script type="text/javascript" src="/lib/loading/okLoading.js"></script>
</head>

<body>
  <textarea name="info" class="layui-textarea"></textarea>

  <script src="/lib/layui/layui.js"></script>
  <script>
    layui.use(["okUtils", "util"], function () {
      let $ = layui.jquery;
      let okUtils = layui.okUtils;
      let util = layui.util;
      okLoading.close();

      let now = new Date().getTime();
      util.countdown(now + 5, now, function (data, serverTime, timer) {
        okUtils.ajax("/api/server/getTask", "get", { taskNo: parent.taskNo }, true).done(function (response) {
          let info = "";
          for (let key in response.data) {
            if (key == "vItem") {
              info += key + "{\n";
              for (let index in response.data[key]) {
                info += "\t" + index + ": " + response.data[key][index].toString() + "\n";
              }
              info += "}\n"
            } else {
              info += key + ": " + response.data[key].toString() + "\n";
            }
          }
          $("textarea[name='info']").val(info);
        }).fail(function (error) {
          $("textarea[name='info']").val(error.msg);
        });
      });

    });
  </script>

</body>

</html>
